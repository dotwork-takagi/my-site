<html>

<head>
    <link rel="stylesheet" href="main.css">
</head>

<body>
    <h1>ドッティーをつかまえろ！（瞬間移動）</h1>
    <span id="gamepoint">
        <span id="current-level"></span>
        <span id="time"></span>
    </span>
    <div id='gamebody'>
        <img src='dotty.svg'>
    </div>
</body>

<script>

    window.onload = function () {

        let clickCount = 0
        let maxLevel = 0
        let time = 10

        const body = document.body
        const gamebody = document.querySelector('#gamebody')
        const img = document.querySelector('img')

        let maxX = gamebody.clientWidth - img.clientWidth
        let maxY = gamebody.clientHeight - img.clientHeight

        let x = 0
        let y = 0

        drawGamepoint()

        img.onmousedown = () => {
            if (time == 10) {
                time -= 1
                setInterval(() => { // 時間を動かす
                    if (time != 10 && time != 0) {
                        time -= 1
                        if (time == 0) {
                            alert('終了です！')
                        }
                        drawGamepoint()
                    }
                }, 1000)
            }
            if (time != 10 && time != 0) {
                success() // クリック成功
                x = getRandomInt(0, maxX)
                y = getRandomInt(0, maxY)
                img.style.transform = `translate(${x}px, ${y}px)`
            }
        }

        function success() { // クリック成功した時
            clickCount += 1
            drawGamepoint()
        }

        function drawGamepoint() { // gamepointを描画する
            document.querySelector('#current-level').innerHTML = `スコア: ${clickCount}回`
            document.querySelector('#time').innerHTML = `時間: ${time}秒`
        }

        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
    }
</script>

</html>